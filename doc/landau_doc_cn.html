<html><head><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"> </script></head> <style>table {border-collapse: collapse;} th, td {border:1px solid; text-align :center}</style> <head><meta charset="UTF8"></head> <h1 align="center">实例 1：使用SymPIC模拟Landau阻尼</h1> <h2>1 简介</h2> <p>Landau阻尼是一种等离子体中常见的波－粒子相互作用现象，即静电波在等离子体或相似的环境中的阻尼。对于其更具体的描述，可以参考 <a href="https://en.wikipedia.org/wiki/Landau_damping">Wiki百科</a> 或任意一本等离子体教材。</p> <h2>2 参数设置</h2> <p>Landau阻尼本质上是一种静电现象，但采用电磁PIC也可以模拟，不过要注意的是初始电荷守恒的问题。考虑一个一维的等离子体体，其背景为不可移动的离子，初始时电场和密度有一个静电扰动，随后该静电波含时演化，由于波与粒子相互作用而被阻尼掉。具体参数参考文章 <a href="https://aip.scitation.org/doi/abs/10.1063/1.4935904">Physics of Plasmas 22, 112504 (2015)。</a>  可按如下设置 <a href="https://github.com/JianyuanXiao/SymPIC/">SymPIC</a>  的配置文件。</p> <script> function func_mcl_1() {var x = document.getElementById("DIV_ID_1");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,249,249);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_1" onClick="event.cancelBubble=true;func_mcl_1()">(<block style="color:RGB(192,0,0);">begin</block><br>&nbsp;&nbsp;<script> function func_mcl_2() {var x = document.getElementById("DIV_ID_2");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,237,237);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_2" onClick="event.cancelBubble=true;func_mcl_2()">(<block style="color:RGB(192,0,0);">defmacro</block> <block style="color:RGB(192,0,0);">many-define</block> lst<br>&nbsp;&nbsp;(<block style="color:RGB(0,128,32);">cons</block> &apos;<block style="color:RGB(192,0,0);">begin</block> (<block style="color:RGB(0,128,32);">map</block> <script> function func_mcl_3() {var x = document.getElementById("DIV_ID_3");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,213,213);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_3" onClick="event.cancelBubble=true;func_mcl_3()">(<block style="color:RGB(192,0,0);">lambda</block> (x)<br>&nbsp;&nbsp;(<block style="color:RGB(0,128,32);">cons</block> &apos;<block style="color:RGB(192,0,0);">define</block> x))</div> lst)))</div><br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">;定义一个用于生成大量define语句的宏

</block> <br><br>&nbsp;&nbsp;<script> function func_mcl_4() {var x = document.getElementById("DIV_ID_4");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,237,237);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_4" onClick="event.cancelBubble=true;func_mcl_4()">(<block style="color:RGB(192,0,0);">many-define</block><br>&nbsp;&nbsp;(REAL_DX <block style="color:RGB(192,0,192);">2.40000000000000006e-04</block>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">;设置格子宽度为2.4e-4m，该参数用于真实单位换算

</block> <br><br>&nbsp;&nbsp;(REAL_MU0 (<block style="color:RGB(0,128,32);">*</block> <block style="color:RGB(192,0,192);">4</block> m_pi <block style="color:RGB(192,0,192);">9.99999999999999955e-08</block>))<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">;该参数设置磁导率为4e-7pi用于真实单位换算，其中m_pi为内建的pi常数值

</block> <br><br>&nbsp;&nbsp;(REAL_NE <block style="color:RGB(192,0,192);">1.20000000000000000e+16</block>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">;设置真实参考数密度为1.2e16/m^3用于单位换算

</block> <br><br>&nbsp;&nbsp;(REAL_ME <block style="color:RGB(192,0,192);">9.10000000000000006e-31</block>)<br>&nbsp;&nbsp;(REAL_E <block style="color:RGB(192,0,192);">1.59999999999999991e-19</block>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">;设置电子质量和净电荷分别为9.1e-31kg和1.6e-19C用于单位换算

</block> <br><br>&nbsp;&nbsp;(REAL_C <block style="color:RGB(192,0,192);">2.99792458000000000e+08</block>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">;设置光速用于单位换算

</block> <br><br>&nbsp;&nbsp;(DELTAT <block style="color:RGB(192,0,192);">5.00000000000000000e-01</block>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">;设置\Delta t=0.5\Delta x/c

</block> <br><br>&nbsp;&nbsp;(E (<block style="color:RGB(0,128,32);">*</block> REAL_E (<block style="color:RGB(0,128,32);">sqrt</block> (<block style="color:RGB(0,128,32);">/</block> REAL_MU0 REAL_ME REAL_DX))))<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">;归一化的电子净电荷

</block> <br><br>&nbsp;&nbsp;(CONST_E_DENSITY (<block style="color:RGB(0,128,32);">*</block> REAL_NE REAL_DX REAL_DX REAL_DX))<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">;归一化的参考数密度

</block> <br><br>&nbsp;&nbsp;(NPG0 <block style="color:RGB(192,0,192);">512</block>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 每格采样点数

</block> <br><br>&nbsp;&nbsp;(NPM0 (<block style="color:RGB(0,128,32);">/</block> CONST_E_DENSITY NPG0))<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 每采样点代表的真实粒子数

</block> <br><br>&nbsp;&nbsp;(XMAX <block style="color:RGB(192,0,192);">8</block>)<br>&nbsp;&nbsp;(YMAX <block style="color:RGB(192,0,192);">1</block>)<br>&nbsp;&nbsp;(ZMAX <block style="color:RGB(192,0,192);">1</block>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 设置每个最小计算单元的三维大小，以格数为单位

</block> <br><br>&nbsp;&nbsp;(NUM_N_HILBERT <block style="color:RGB(192,0,192);">5</block>)<br>&nbsp;&nbsp;(NUM_N_HILBERT_DIMENSION <block style="color:RGB(192,0,192);">1</block>)<br>&nbsp;&nbsp;(HILBERT_DIR <block style="color:RGB(192,0,192);">0</block>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 设置Hilbert填充曲线阶数为5，维数为1，扩展方向为0，即x方向，总的模拟区域为256x1x1

</block> <br><br>&nbsp;&nbsp;(NUM_SPEC <block style="color:RGB(192,0,192);">1</block>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 设置粒子种数为1

</block> <br><br>&nbsp;&nbsp;(NUM_TIMESTEP <block style="color:RGB(192,0,192);">15001</block>)<br>&nbsp;&nbsp;(NUM_DUMP_TIMESTEP <block style="color:RGB(192,0,192);">100</block>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 设置总时间步数为15000，每100步输出一次

</block> <br><br>&nbsp;&nbsp;(gen_simulate_B <script> function func_mcl_5() {var x = document.getElementById("DIV_ID_5");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_5" onClick="event.cancelBubble=true;func_mcl_5()">(<block style="color:RGB(192,0,0);">lambda</block> (x)<br>&nbsp;&nbsp;(runc <block style="color:RGB(224,0,192)">&quot;x/(E*REAL_C/REAL_DX*REAL_ME/REAL_E)&quot;</block>))</div>)<br>&nbsp;&nbsp;(gen_simulate_E <script> function func_mcl_6() {var x = document.getElementById("DIV_ID_6");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_6" onClick="event.cancelBubble=true;func_mcl_6()">(<block style="color:RGB(192,0,0);">lambda</block> (x)<br>&nbsp;&nbsp;(runc <block style="color:RGB(224,0,192)">&quot;x/(E*REAL_C*REAL_C/REAL_DX*REAL_ME/REAL_E)&quot;</block>))</div>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 此二函数用于生成归一化的电磁场，其中runc是一个用于将中缀表达式转为s-expression的前缀表达式的宏

</block> <br><br>&nbsp;&nbsp;(USE_CHECKPOINT <block style="color:RGB(192,0,192);">1</block>)<br>&nbsp;&nbsp;(NUM_CHECKPOINT_TIMESTEP <block style="color:RGB(192,0,192);">5000</block>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 使用checkpoint，每5000步输出一次checkpoint

</block> <br><br>&nbsp;&nbsp;(GET_INIT_FILTER_KROOK <script> function func_mcl_7() {var x = document.getElementById("DIV_ID_7");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_7" onClick="event.cancelBubble=true;func_mcl_7()">(<block style="color:RGB(192,0,0);">lambda</block> x<br>&nbsp;&nbsp;<block style="color:RGB(192,0,192);">0</block>)</div>)<br>&nbsp;&nbsp;(GET_INIT_FILTER_E <script> function func_mcl_8() {var x = document.getElementById("DIV_ID_8");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_8" onClick="event.cancelBubble=true;func_mcl_8()">(<block style="color:RGB(192,0,0);">lambda</block> x<br>&nbsp;&nbsp;<block style="color:RGB(192,0,192);">0</block>)</div>)<br>&nbsp;&nbsp;(GET_INIT_FILTER_B <script> function func_mcl_9() {var x = document.getElementById("DIV_ID_9");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_9" onClick="event.cancelBubble=true;func_mcl_9()">(<block style="color:RGB(192,0,0);">lambda</block> x<br>&nbsp;&nbsp;<block style="color:RGB(192,0,192);">0</block>)</div>)<br>&nbsp;&nbsp;(GET_INIT_TEMPERATURE_DIST <script> function func_mcl_10() {var x = document.getElementById("DIV_ID_10");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_10" onClick="event.cancelBubble=true;func_mcl_10()">(<block style="color:RGB(192,0,0);">lambda</block> x<br>&nbsp;&nbsp;<block style="color:RGB(192,0,192);">1</block>)</div>)<br>&nbsp;&nbsp;(NUM_PROCESS <block style="color:RGB(192,0,192);">2</block>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 设置总MPI进程数为2

</block> <br><br>&nbsp;&nbsp;(NUM_MAX_RUNTIME <block style="color:RGB(192,0,192);">1</block>)<br>&nbsp;&nbsp;(NUM_RUNTIME <block style="color:RGB(192,0,192);">1</block>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 设置总runtime数为1

</block> <br><br>&nbsp;&nbsp;(GET_DEV_TYPE <script> function func_mcl_11() {var x = document.getElementById("DIV_ID_11");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_11" onClick="event.cancelBubble=true;func_mcl_11()">(<block style="color:RGB(192,0,0);">lambda</block> (x r)<br>&nbsp;&nbsp;<block style="color:RGB(192,0,192);">1</block>)</div>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 使用1号runtime OpenMP

</block> <br><br>&nbsp;&nbsp;(GET_DEV_ID <script> function func_mcl_12() {var x = document.getElementById("DIV_ID_12");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_12" onClick="event.cancelBubble=true;func_mcl_12()">(<block style="color:RGB(192,0,0);">lambda</block> (x r)<br>&nbsp;&nbsp;<block style="color:RGB(192,0,192);">0</block>)</div>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 使用0号设备id

</block> <br><br>&nbsp;&nbsp;(E_0 <block style="color:RGB(192,0,192);">-1</block>)<br>&nbsp;&nbsp;(M_0 <block style="color:RGB(192,0,192);">1</block>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; E_0与M_0为电子的相对电荷与质量

</block> <br><br>&nbsp;&nbsp;(GET_MASS <script> function func_mcl_13() {var x = document.getElementById("DIV_ID_13");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_13" onClick="event.cancelBubble=true;func_mcl_13()">(<block style="color:RGB(192,0,0);">lambda</block> (i)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">case</block> i (<block style="color:RGB(192,0,192);">0</block> (<block style="color:RGB(0,128,32);">*</block> M_0 NPM0)) (<block style="color:RGB(192,0,0);">else</block> <block style="color:RGB(192,0,192);">1</block>)))</div>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 设置第0种粒子质量为M_0*NPM0

</block> <br><br>&nbsp;&nbsp;(GET_CHARGE <script> function func_mcl_14() {var x = document.getElementById("DIV_ID_14");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_14" onClick="event.cancelBubble=true;func_mcl_14()">(<block style="color:RGB(192,0,0);">lambda</block> (i)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">case</block> i (<block style="color:RGB(192,0,192);">0</block> (<block style="color:RGB(0,128,32);">*</block> E_0 E NPM0)) (<block style="color:RGB(192,0,0);">else</block> <block style="color:RGB(192,0,192);">0</block>)))</div>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 设置第0种粒子电荷为E*M_0*NPM0

</block> <br><br>&nbsp;&nbsp;(USE_INIT_EB0 <block style="color:RGB(192,0,192);">1</block>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 使用初条件场

</block> <br><br>&nbsp;&nbsp;(USE_FILTER <block style="color:RGB(192,0,192);">0</block>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 不使用电磁场过滤

</block> <br><br>&nbsp;&nbsp;(USE_NP_BOUNDARY <block style="color:RGB(192,0,192);">0</block>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 不使用非周期边界

</block> <br><br>&nbsp;&nbsp;(USE_NON_UNI_DENSITY <block style="color:RGB(192,0,192);">1</block>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 不使用非均匀粒子

</block> <br><br>&nbsp;&nbsp;(USE_NON_UNI_TEMPERATURE <block style="color:RGB(192,0,192);">0</block>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 不使用非均匀温度

</block> <br><br>&nbsp;&nbsp;(USE_INIT_EXT_EB <block style="color:RGB(192,0,192);">0</block>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 不使用外场

</block> <br><br>&nbsp;&nbsp;(USE_INIT_V0 <block style="color:RGB(192,0,192);">0</block>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 不使用初始漂移Maxwell分布

</block> <br><br>&nbsp;&nbsp;(CAL_FUN_ONE_PARA <script> function func_mcl_15() {var x = document.getElementById("DIV_ID_15");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_15" onClick="event.cancelBubble=true;func_mcl_15()">(<block style="color:RGB(192,0,0);">lambda</block> (s x)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> s1 (<block style="color:RGB(0,128,32);">string-&gt;symbol</block> s))<br>&nbsp;&nbsp;<script> function func_mcl_16() {var x = document.getElementById("DIV_ID_16");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,207,207);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_16" onClick="event.cancelBubble=true;func_mcl_16()">(<block style="color:RGB(192,0,0);">if</block> (symbol-binded? s1)<br>&nbsp;&nbsp;((<block style="color:RGB(0,128,32);">eval</block> (<block style="color:RGB(0,128,32);">string-&gt;symbol</block> s)) x)<br>&nbsp;&nbsp;<script> function func_mcl_17() {var x = document.getElementById("DIV_ID_17");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,195,195);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_17" onClick="event.cancelBubble=true;func_mcl_17()">(<block style="color:RGB(192,0,0);">begin</block><br>&nbsp;&nbsp;(write-string (multi-concat <block style="color:RGB(224,0,192)">&quot;Warning: symbol &quot;</block> s1 <block style="color:RGB(224,0,192)">&quot; is unbounded\n&quot;</block>) current-error-port)<br>&nbsp;&nbsp;(<block style="color:RGB(0,128,32);">car</block> <block style="color:RGB(192,0,192);">0</block>))</div>)</div>)</div>)<br>&nbsp;&nbsp;(GET_GRID_CACHE_LEN <script> function func_mcl_18() {var x = document.getElementById("DIV_ID_18");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_18" onClick="event.cancelBubble=true;func_mcl_18()">(<block style="color:RGB(192,0,0);">lambda</block> (i)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">case</block> i (<block style="color:RGB(192,0,192);">0</block> <block style="color:RGB(192,0,192);">640</block>) (<block style="color:RGB(192,0,0);">else</block> <block style="color:RGB(192,0,192);">0</block>)))</div>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 设置每格第i种粒子预分配空间可存的粒子数

</block> <br><br>&nbsp;&nbsp;(GET_CU_CACHE_LEN <script> function func_mcl_19() {var x = document.getElementById("DIV_ID_19");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_19" onClick="event.cancelBubble=true;func_mcl_19()">(<block style="color:RGB(192,0,0);">lambda</block> (i)<br>&nbsp;&nbsp;<block style="color:RGB(192,0,192);">12800</block>)</div>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 设置每Compute Unit第i种粒子用于排序等分配的空间可存的粒子数

</block> <br><br>&nbsp;&nbsp;(GET_INIT_LOAD <script> function func_mcl_20() {var x = document.getElementById("DIV_ID_20");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_20" onClick="event.cancelBubble=true;func_mcl_20()">(<block style="color:RGB(192,0,0);">lambda</block> (i)<br>&nbsp;&nbsp;NPG0)</div>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 设置初始化时第i种粒子每格采样点参考值

</block> <br><br>&nbsp;&nbsp;(USE_NON_UNI_CACHE_DIST <block style="color:RGB(192,0,192);">0</block>)<br>&nbsp;&nbsp;(GET_NON_UNI_CACHE_DIST <script> function func_mcl_21() {var x = document.getElementById("DIV_ID_21");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_21" onClick="event.cancelBubble=true;func_mcl_21()">(<block style="color:RGB(192,0,0);">lambda</block> x<br>&nbsp;&nbsp;<block style="color:RGB(192,0,192);">0</block>)</div>)<br>&nbsp;&nbsp;(N_MODE <block style="color:RGB(192,0,192);">1</block>)<br>&nbsp;&nbsp;(E_AMP (gen_simulate_E (<block style="color:RGB(0,128,32);">*</block> <block style="color:RGB(192,0,192);">1.08000000000000000e+05</block>)))<br>&nbsp;&nbsp;(GET_INIT_DENSITY_DIST <script> function func_mcl_22() {var x = document.getElementById("DIV_ID_22");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_22" onClick="event.cancelBubble=true;func_mcl_22()">(<block style="color:RGB(192,0,0);">lambda</block> (i z y x)<br>&nbsp;&nbsp;(<block style="color:RGB(0,128,32);">-</block> <block style="color:RGB(192,0,192);">1</block> (<block style="color:RGB(0,128,32);">*</block> E_AMP (<block style="color:RGB(0,128,32);">/</block> (<block style="color:RGB(0,128,32);">*</block> <block style="color:RGB(192,0,192);">2</block> m_pi N_MODE) (<block style="color:RGB(0,128,32);">*</block> X_ALL E_0 E NPM0 NPG0)) (<block style="color:RGB(0,128,32);">sin</block> (<block style="color:RGB(0,128,32);">/</block> (<block style="color:RGB(0,128,32);">*</block> N_MODE x m_pi <block style="color:RGB(192,0,192);">2</block>) X_ALL)))))</div>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 初始电场振幅为108kV/m

</block> <br><br>&nbsp;&nbsp;(X_ALL (<block style="color:RGB(0,128,32);">*</block> XMAX (arithmetic-shift <block style="color:RGB(192,0,192);">1</block> NUM_N_HILBERT)))<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 计算模拟区域x方向为256个格点

</block> <br><br>&nbsp;&nbsp;(GET_INIT_E0 <script> function func_mcl_23() {var x = document.getElementById("DIV_ID_23");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_23" onClick="event.cancelBubble=true;func_mcl_23()">(<block style="color:RGB(192,0,0);">lambda</block> (z y x l)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">case</block> l (<block style="color:RGB(192,0,192);">0</block> (<block style="color:RGB(0,128,32);">*</block> E_AMP (<block style="color:RGB(0,128,32);">cos</block> (<block style="color:RGB(0,128,32);">/</block> (<block style="color:RGB(0,128,32);">*</block> N_MODE x m_pi <block style="color:RGB(192,0,192);">2</block>) X_ALL)))) (<block style="color:RGB(192,0,0);">else</block> <block style="color:RGB(192,0,192);">0</block>)))</div>)<br>&nbsp;&nbsp;(GET_INIT_B0 <script> function func_mcl_24() {var x = document.getElementById("DIV_ID_24");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_24" onClick="event.cancelBubble=true;func_mcl_24()">(<block style="color:RGB(192,0,0);">lambda</block> (z y x l)<br>&nbsp;&nbsp;<block style="color:RGB(192,0,192);">0</block>)</div>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 此二函数用于设置初始电磁场

</block> <br><br>&nbsp;&nbsp;(GET_INIT_E <script> function func_mcl_25() {var x = document.getElementById("DIV_ID_25");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_25" onClick="event.cancelBubble=true;func_mcl_25()">(<block style="color:RGB(192,0,0);">lambda</block> (z y x l)<br>&nbsp;&nbsp;<block style="color:RGB(192,0,192);">0</block>)</div>)<br>&nbsp;&nbsp;(GET_INIT_B <script> function func_mcl_26() {var x = document.getElementById("DIV_ID_26");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_26" onClick="event.cancelBubble=true;func_mcl_26()">(<block style="color:RGB(192,0,0);">lambda</block> (z y x l)<br>&nbsp;&nbsp;<block style="color:RGB(192,0,192);">0</block>)</div>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 此二函数用于设置不变的外电磁场

</block> <br><br>&nbsp;&nbsp;(GET_INIT_VT <script> function func_mcl_27() {var x = document.getElementById("DIV_ID_27");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_27" onClick="event.cancelBubble=true;func_mcl_27()">(<block style="color:RGB(192,0,0);">lambda</block> (i)<br>&nbsp;&nbsp;<block style="color:RGB(192,0,192);">1.00000000000000006e-01</block>)</div>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 设置电子热速度为0.07c

</block> <br><br>&nbsp;&nbsp;(GET_VAR <script> function func_mcl_28() {var x = document.getElementById("DIV_ID_28");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_28" onClick="event.cancelBubble=true;func_mcl_28()">(<block style="color:RGB(192,0,0);">lambda</block> (s)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> s1 (<block style="color:RGB(0,128,32);">string-&gt;symbol</block> s))<br>&nbsp;&nbsp;<script> function func_mcl_29() {var x = document.getElementById("DIV_ID_29");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,207,207);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_29" onClick="event.cancelBubble=true;func_mcl_29()">(<block style="color:RGB(192,0,0);">if</block> (symbol-binded? s1)<br>&nbsp;&nbsp;(<block style="color:RGB(0,128,32);">eval</block> (<block style="color:RGB(0,128,32);">string-&gt;symbol</block> s))<br>&nbsp;&nbsp;<script> function func_mcl_30() {var x = document.getElementById("DIV_ID_30");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,195,195);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_30" onClick="event.cancelBubble=true;func_mcl_30()">(<block style="color:RGB(192,0,0);">begin</block><br>&nbsp;&nbsp;(write-string (multi-concat <block style="color:RGB(224,0,192)">&quot;Warning: symbol &quot;</block> s1 <block style="color:RGB(224,0,192)">&quot; is unbounded\n&quot;</block>) current-error-port)<br>&nbsp;&nbsp;<block style="color:RGB(192,0,192);">0</block>)</div>)</div>)</div>)<br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 此函数用于动态加载变量

</block> <br><br>&nbsp;&nbsp;<block style="color:RGB(108,108,108)">; 以下参数用于其它无关选项

</block> <br><br>&nbsp;&nbsp;(GET_INIT_V0_x <script> function func_mcl_31() {var x = document.getElementById("DIV_ID_31");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_31" onClick="event.cancelBubble=true;func_mcl_31()">(<block style="color:RGB(192,0,0);">lambda</block> x<br>&nbsp;&nbsp;<block style="color:RGB(192,0,192);">0</block>)</div>)<br>&nbsp;&nbsp;(GET_INIT_V0_y <script> function func_mcl_32() {var x = document.getElementById("DIV_ID_32");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_32" onClick="event.cancelBubble=true;func_mcl_32()">(<block style="color:RGB(192,0,0);">lambda</block> x<br>&nbsp;&nbsp;<block style="color:RGB(192,0,192);">0</block>)</div>)<br>&nbsp;&nbsp;(GET_INIT_V0_z <script> function func_mcl_33() {var x = document.getElementById("DIV_ID_33");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_33" onClick="event.cancelBubble=true;func_mcl_33()">(<block style="color:RGB(192,0,0);">lambda</block> x<br>&nbsp;&nbsp;<block style="color:RGB(192,0,192);">0</block>)</div>)<br>&nbsp;&nbsp;(USE_KGM <block style="color:RGB(192,0,192);">0</block>)<br>&nbsp;&nbsp;(USE_DM <block style="color:RGB(192,0,192);">0</block>)<br>&nbsp;&nbsp;(USE_TORI <block style="color:RGB(192,0,192);">0</block>)<br>&nbsp;&nbsp;(USE_PROFILE <block style="color:RGB(192,0,192);">0</block>)<br>&nbsp;&nbsp;(USE_LHCD_INPUT <block style="color:RGB(192,0,192);">0</block>)<br>&nbsp;&nbsp;(USE_NON_UNI_CACHE_DIST <block style="color:RGB(192,0,192);">0</block>)<br>&nbsp;&nbsp;(GET_NUM_LOCAL_THREAD_FROM_GLOBAL_TID <script> function func_mcl_34() {var x = document.getElementById("DIV_ID_34");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_34" onClick="event.cancelBubble=true;func_mcl_34()">(<block style="color:RGB(192,0,0);">lambda</block> x<br>&nbsp;&nbsp;x)</div>)<br>&nbsp;&nbsp;(GET_NPM <script> function func_mcl_35() {var x = document.getElementById("DIV_ID_35");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_35" onClick="event.cancelBubble=true;func_mcl_35()">(<block style="color:RGB(192,0,0);">lambda</block> (i)<br>&nbsp;&nbsp;<block style="color:RGB(192,0,192);">1</block>)</div>))</div>)</div> <h2>3  运行</h2> <p> 在sympic运行时，需要设置环境变量STDLIB指向stdlib.scm的位置。在SymPIC的根目录下，执行以下命令以设置该环境变量：</p> <div style="color:RGB(0,255,0);background-color:RGB(24,24,24);font-family:monospace;"><block>$ export STDLIB=$PWD/stdlib.scm</block> <br> <block>$ export SYMPIC_DIR=$PWD</block> <br> </div> <p> 将第二节2中的参数保存成文件landau_damping.ss，假设系统中共有4个CPU线程，则使用以下命令运行：</p> <div style="color:RGB(0,255,0);background-color:RGB(24,24,24);font-family:monospace;"><block>$ export OMP_NUM_THREADS=2</block> <br> <block>$ mpirun -n 2 $SYMPIC_DIR/sympic landau_damping.ss</block> <br> </div> <p> 运行完毕后，会生成tmpEN, tmpEB和tmpJ这三个文件。可以在python中查看Landau阻尼效果。使用</p> <div style="color:RGB(0,255,0);background-color:RGB(24,24,24);font-family:monospace;"><block>$ ipython --pylab</block> <br> </div> <p> 启动matplotlib，然后在终端中运行</p> <div style="color:RGB(0,255,0);background-color:RGB(24,24,24);font-family:monospace;"><block> In [1]: execfile(&apos;path-to-SymPIC-dir/cgapsio/pygapsio.py&apos;)</block> <br> <block> </block> <br> <block> In [2]: tEB=GAPS_IO_Load(&apos;tmpEB&apos;)</block> <br> <block> </block> <br> <block> In [3]: tEB=reshape(tEB,[len(tEB)/2,2,256,3])</block> <br> <block> </block> <br> <block> In [4]: ftEB=fftn(tEB[:,0,:,0],axes=[1])</block> <br> <block> </block> <br> <block> In [5]: plot(log(abs(real(ftEB[:,1]))));</block> <br> </div> <p> 如一切正常，类似下图的静电波模式为1的振幅含时演化将被画出。</p> <img src="ld1.png" width="540px"></html>