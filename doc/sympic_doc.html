<html><head><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"> </script></head> <style>table {border-collapse: collapse;} th, td {border:1px solid; text-align :center}</style> <head><meta charset="UTF8"></head> <h1 align="center">Manual of the SymPIC</h1> <h2>1 Introduction</h2> <p>A configuration file of <a href="https://github.com/JianyuanXiao/SymPIC/">SymPIC</a> is a scheme (a dialect of lisp) source code. Before the PIC iteration, the configuration file will be firstly loaded and evaluated by a built-in scheme interpreter, and configuration parameters are directly read from variables in evaluated results. For more information of the scheme or lisp language, please refer to textbooks such as  <b>The Little Schemer</b> ,  <b>Structure and Interpretation of Computer Programs</b>  or  <b>ANSI Common Lisp</b> .</p> <h2>2 Environment Setup</h2> <p> The only one environment variable for the SymPIC to run is STDLIB, which should be the location of the stdlib.scm originally in the SymPIC directory.</p> <div style="color:RGB(0,255,0);background-color:RGB(24,24,24);font-family:monospace;"><block>$ export STDLIB=path-to-sympic-dir/stdlib.scm</block> <br> <block>$ path-to-SymPIC-dir/comp config.ss</block> <br> </div> <h2>3 Grid Setup and Parallel Subdomain Decomposition</h2> <p>The basic <b>calculation unit</b> in the PIC iteration is decided by the shape of XMAX*YMAX*ZMAX, for example,</p> <script> function func_mcl_1() {var x = document.getElementById("DIV_ID_1");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,249,249);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_1" onClick="event.cancelBubble=true;func_mcl_1()">(<block style="color:RGB(192,0,0);">begin</block><br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> XMAX <block style="color:RGB(192,0,192);">4</block>)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> YMAX <block style="color:RGB(192,0,192);">8</block>)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> ZMAX <block style="color:RGB(192,0,192);">3</block>))</div> <p>defines the  <b>calculation unit</b> which contains 4x8x3 grids.</p> <p>Using the  <a href="https://en.wikipedia.org/wiki/Hilbert_curve">Hilbert space filling curve</a> , the computational domain can be expanded. For example,</p> <script> function func_mcl_2() {var x = document.getElementById("DIV_ID_2");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,249,249);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_2" onClick="event.cancelBubble=true;func_mcl_2()">(<block style="color:RGB(192,0,0);">begin</block><br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> NUM_N_HILBERT_DIMENSION <block style="color:RGB(192,0,192);">2</block>)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> NUM_N_HILBERT <block style="color:RGB(192,0,192);">3</block>)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> HILBERT_DIR <block style="color:RGB(192,0,192);">1</block>))</div> <p>defines a 2-dimensional 3rd-order Hilbert curve, and its normal vector is pointed to 1 (y) direction. So in this case the Hilbert curve is 8x1x8, and the total calculation domain is 32x8x24.</p> <p>Note that if you need 2 or 1-dimensional simulation, then shape for both <b>calculation unit</b> and Hilbert curve should also be 2 or 1-dimensional. For example, </p> <script> function func_mcl_3() {var x = document.getElementById("DIV_ID_3");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,249,249);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_3" onClick="event.cancelBubble=true;func_mcl_3()">(<block style="color:RGB(192,0,0);">begin</block><br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> XMAX <block style="color:RGB(192,0,192);">6</block>)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> YMAX <block style="color:RGB(192,0,192);">5</block>)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> ZMAX <block style="color:RGB(192,0,192);">1</block>)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> NUM_N_HILBERT_DIMENSION <block style="color:RGB(192,0,192);">2</block>)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> NUM_N_HILBERT <block style="color:RGB(192,0,192);">2</block>)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> HILBERT_DIR <block style="color:RGB(192,0,192);">2</block>))</div> <p>will set the total calculation domain to 24x20x1, </p> <script> function func_mcl_4() {var x = document.getElementById("DIV_ID_4");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,249,249);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_4" onClick="event.cancelBubble=true;func_mcl_4()">(<block style="color:RGB(192,0,0);">begin</block><br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> XMAX <block style="color:RGB(192,0,192);">8</block>)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> YMAX <block style="color:RGB(192,0,192);">1</block>)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> ZMAX <block style="color:RGB(192,0,192);">1</block>)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> NUM_N_HILBERT_DIMENSION <block style="color:RGB(192,0,192);">1</block>)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> NUM_N_HILBERT <block style="color:RGB(192,0,192);">3</block>)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> HILBERT_DIR <block style="color:RGB(192,0,192);">0</block>))</div> <p>will set the total calculation domain to 64x1x1. If in one direction has multiple grids, then the shape of <b>calculation unit</b> in this direction should be at least set to 2.</p> <p>One <b>compute unit</b> (one CPU core or GPU SIMD unit) will be assigned integer multiple of <b>calculation unit</b> task(s), so the total number of <b>compute units</b> should be smaller than (2^NUM_N_HILBERT)^NUM_N_HILBERT_DIMENSION to avoid wasting.</p> <h2>4 Plasma Parameters</h2> <h3>4.1 Time Setup</h3> <p>The timestep and total number of timesteps can be set via DELTAT and NUM_TIMESTEP.</p> <h3>4.2 Initialization of Particles</h3> <p>The number of particle species can be specified by the NUM_SPEC variable. For example,</p> (<block style="color:RGB(192,0,0);">define</block> NUM_SPEC <block style="color:RGB(192,0,192);">2</block>) <p>will use 2 species of particles.</p> <p>Mass and charge of each species of sampling points of particles can be set via GET_MASS and GET_CHARGE function, for example, </p> <script> function func_mcl_5() {var x = document.getElementById("DIV_ID_5");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,249,249);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_5" onClick="event.cancelBubble=true;func_mcl_5()">(<block style="color:RGB(192,0,0);">begin</block><br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> NPM <block style="color:RGB(192,0,192);">100</block>)<br>&nbsp;&nbsp;<script> function func_mcl_6() {var x = document.getElementById("DIV_ID_6");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,237,237);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_6" onClick="event.cancelBubble=true;func_mcl_6()">(<block style="color:RGB(192,0,0);">define</block> (GET_MASS i) (<block style="color:RGB(192,0,0);">case</block> i (<block style="color:RGB(192,0,192);">0</block> (<block style="color:RGB(0,128,32);">*</block> <block style="color:RGB(192,0,192);">1</block> NPM)) (<block style="color:RGB(192,0,192);">1</block> (<block style="color:RGB(0,128,32);">*</block> <block style="color:RGB(192,0,192);">1836</block> NPM)) (<block style="color:RGB(192,0,0);">else</block> <block style="color:RGB(192,0,192);">1</block>)))</div><br>&nbsp;&nbsp;<script> function func_mcl_7() {var x = document.getElementById("DIV_ID_7");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,237,237);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_7" onClick="event.cancelBubble=true;func_mcl_7()">(<block style="color:RGB(192,0,0);">define</block> (GET_MASS i) (<block style="color:RGB(192,0,0);">case</block> i (<block style="color:RGB(192,0,192);">0</block> (<block style="color:RGB(0,128,32);">*</block> <block style="color:RGB(192,0,192);">-1</block> NPM E0)) (<block style="color:RGB(192,0,192);">1</block> (<block style="color:RGB(0,128,32);">*</block> NPM E0)) (<block style="color:RGB(192,0,0);">else</block> <block style="color:RGB(192,0,192);">1</block>)))</div>)</div> <p>For velocity space, currently Maxwellian and lost cone distribution are supported. The GET_INIT_VT function can specify the thermal velocity of each particle species. For example,</p> (<block style="color:RGB(192,0,0);">define</block> GET_INIT_VT <script> function func_mcl_8() {var x = document.getElementById("DIV_ID_8");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,243,243);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_8" onClick="event.cancelBubble=true;func_mcl_8()">(<block style="color:RGB(192,0,0);">lambda</block> (i)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">case</block> i (<block style="color:RGB(192,0,192);">0</block> <block style="color:RGB(192,0,192);">1.00000000000000006e-01</block>) (<block style="color:RGB(192,0,192);">1</block> <block style="color:RGB(192,0,192);">4.00000000000000008e-03</block>) (<block style="color:RGB(192,0,0);">else</block> <block style="color:RGB(192,0,192);">0</block>)))</div>) <p>will set the thermal velocities of 0th and 1st particle to 0.1 and 0.004, respectively. To use non-uniform temperature, firstly USE_NON_UNI_TEMPERATURE should be set to 1, and the use GET_INIT_TEMPERATURE_DIST to specify the temperature dist. For example,</p> <script> function func_mcl_9() {var x = document.getElementById("DIV_ID_9");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,249,249);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_9" onClick="event.cancelBubble=true;func_mcl_9()">(<block style="color:RGB(192,0,0);">begin</block><br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> USE_NON_UNI_TEMPERATURE <block style="color:RGB(192,0,192);">1</block>)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> GET_INIT_TEMPERATURE_DIST <script> function func_mcl_10() {var x = document.getElementById("DIV_ID_10");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,231,231);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_10" onClick="event.cancelBubble=true;func_mcl_10()">(<block style="color:RGB(192,0,0);">lambda</block> (i z y x l)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">case</block> i (<block style="color:RGB(192,0,192);">0</block> (<block style="color:RGB(0,128,32);">*</block> (<block style="color:RGB(0,128,32);">+</block> <block style="color:RGB(192,0,192);">1</block> (<block style="color:RGB(0,128,32);">cos</block> x)) (<block style="color:RGB(192,0,0);">case</block> l (<block style="color:RGB(192,0,192);">0</block> <block style="color:RGB(192,0,192);">5.00000000000000000e-01</block>) (<block style="color:RGB(192,0,192);">1</block> <block style="color:RGB(192,0,192);">1.19999999999999996e+00</block>) (<block style="color:RGB(192,0,192);">2</block> <block style="color:RGB(192,0,192);">1.00000000000000000e+00</block>) (<block style="color:RGB(192,0,0);">else</block> <block style="color:RGB(192,0,192);">0</block>)))) (<block style="color:RGB(192,0,192);">1</block> (<block style="color:RGB(0,128,32);">-</block> <block style="color:RGB(192,0,192);">1</block> (<block style="color:RGB(0,128,32);">sin</block> (<block style="color:RGB(0,128,32);">/</block> y <block style="color:RGB(192,0,192);">2</block>)))) (<block style="color:RGB(192,0,0);">else</block> <block style="color:RGB(192,0,192);">0</block>)))</div>))</div> <p>sets the thermal speed in x, y, z directions of the 0th particle to (1+cos(x))*0.5*GET_INIT_VT(0), (1+cos(x))*1.2*GET_INIT_VT(0), (1+cos(x))*1.0*GET_INIT_VT(0), respectively, sets the thermal speed of the 1st particle to (1-sin(y/2))*GET_INIT_VT(1). The GET_INIT_LOAD function will set number of sampling points per grid. For example,</p> (<block style="color:RGB(192,0,0);">define</block> GET_INIT_LOAD <script> function func_mcl_11() {var x = document.getElementById("DIV_ID_11");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,243,243);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_11" onClick="event.cancelBubble=true;func_mcl_11()">(<block style="color:RGB(192,0,0);">lambda</block> (i)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">case</block> i (<block style="color:RGB(192,0,192);">0</block> <block style="color:RGB(192,0,192);">100</block>) (<block style="color:RGB(192,0,192);">1</block> <block style="color:RGB(192,0,192);">50</block>)))</div>) <p>sets the number of sampling points per grid of 0th and 1st particle to 100 and 50, respectively.</p> <p>Non-uniform density can be set via USE_NON_UNI_DENSITY and GET_INIT_DENSITY_DIST. For example,</p> <script> function func_mcl_12() {var x = document.getElementById("DIV_ID_12");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,249,249);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_12" onClick="event.cancelBubble=true;func_mcl_12()">(<block style="color:RGB(192,0,0);">begin</block><br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> USE_NON_UNI_DENSITY <block style="color:RGB(192,0,192);">1</block>)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> GET_INIT_DENSITY_DIST <script> function func_mcl_13() {var x = document.getElementById("DIV_ID_13");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,231,231);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_13" onClick="event.cancelBubble=true;func_mcl_13()">(<block style="color:RGB(192,0,0);">lambda</block> (i z y x)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">case</block> i (<block style="color:RGB(192,0,192);">0</block> (<block style="color:RGB(0,128,32);">exp</block> (<block style="color:RGB(0,128,32);">-</block> (<block style="color:RGB(0,128,32);">+</block> (<block style="color:RGB(0,128,32);">*</block> x x) (<block style="color:RGB(0,128,32);">*</block> y y))))) (<block style="color:RGB(192,0,192);">1</block> (<block style="color:RGB(0,128,32);">exp</block> (<block style="color:RGB(0,128,32);">-</block> (<block style="color:RGB(0,128,32);">+</block> (<block style="color:RGB(0,128,32);">*</block> z z) (<block style="color:RGB(0,128,32);">*</block> y y))))) (<block style="color:RGB(192,0,0);">else</block> <block style="color:RGB(192,0,192);">0</block>)))</div>))</div> <sets>the number of sampling points per grid of 0th and 1st particle to GET_INIT_LOAD(0)*exp(-(x*x+y*y)) and GET_INIT_LOAD(1)*exp(-(y*y+z*z)), respectively.</sets> <h3>4.3 Initialization of Fields</h3> <p>Following parameters are used for setting initial and external fields. For example for initial E and B, </p> <script> function func_mcl_14() {var x = document.getElementById("DIV_ID_14");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,249,249);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_14" onClick="event.cancelBubble=true;func_mcl_14()">(<block style="color:RGB(192,0,0);">begin</block><br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> USE_INIT_EB0 <block style="color:RGB(192,0,192);">1</block>)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> GET_INIT_E0 <script> function func_mcl_15() {var x = document.getElementById("DIV_ID_15");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,231,231);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_15" onClick="event.cancelBubble=true;func_mcl_15()">(<block style="color:RGB(192,0,0);">lambda</block> (z y x l)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">case</block> l (<block style="color:RGB(192,0,192);">0</block> <block style="color:RGB(192,0,192);">1</block>) (<block style="color:RGB(192,0,0);">else</block> <block style="color:RGB(192,0,192);">0</block>)))</div>)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> GET_INIT_B0 <script> function func_mcl_16() {var x = document.getElementById("DIV_ID_16");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,231,231);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_16" onClick="event.cancelBubble=true;func_mcl_16()">(<block style="color:RGB(192,0,0);">lambda</block> (z y x l)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">case</block> l (<block style="color:RGB(192,0,192);">1</block> <block style="color:RGB(192,0,192);">1</block>) (<block style="color:RGB(192,0,0);">else</block> <block style="color:RGB(192,0,192);">0</block>)))</div>))</div> <p>will set the initial E and B to [1,0,0] and [0,1,0], respectively. For external E and B, the following code</p> <script> function func_mcl_17() {var x = document.getElementById("DIV_ID_17");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,249,249);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_17" onClick="event.cancelBubble=true;func_mcl_17()">(<block style="color:RGB(192,0,0);">begin</block><br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> USE_INIT_EXT_EB <block style="color:RGB(192,0,192);">1</block>)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> GET_INIT_E <script> function func_mcl_18() {var x = document.getElementById("DIV_ID_18");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,231,231);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_18" onClick="event.cancelBubble=true;func_mcl_18()">(<block style="color:RGB(192,0,0);">lambda</block> (z y x l)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">case</block> l (<block style="color:RGB(192,0,192);">1</block> (<block style="color:RGB(0,128,32);">log</block> z)) (<block style="color:RGB(192,0,0);">else</block> <block style="color:RGB(192,0,192);">0</block>)))</div>)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> GET_INIT_B <script> function func_mcl_19() {var x = document.getElementById("DIV_ID_19");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,231,231);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_19" onClick="event.cancelBubble=true;func_mcl_19()">(<block style="color:RGB(192,0,0);">lambda</block> (z y x l)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">case</block> l (<block style="color:RGB(192,0,192);">2</block> <block style="color:RGB(192,0,192);">2</block>) (<block style="color:RGB(192,0,0);">else</block> <block style="color:RGB(192,0,192);">0</block>)))</div>))</div> <p>will set the external E and B to [0,log(z),0] and [0,0,2]</p> <h3>4.4 Unit Normalization</h3> <p>We may now introduce the unit normalization. The unit constraint in the SymPIC is the speed of light and the grid size, which are set to 1. So if the real grid size is \(\Delta x\), and the speed of light is \(\mathrm{c}\), then the normalized time is \(\Delta x/\mathrm{c}\). Usually the time step DELTAT is set to 0.5, which means the real time step is \(0.5\Delta x/\mathrm{c}\), to comply the CFL constraint, however if the gyro-period or the plasma frequency of electrons are too large then the DELTAT should be smaller enough to resolve the fastest physics.</p> <p>Suppose the charge and mass of the \(s\)-th species are \(q_s=\)GET_CHARGE(\(s\)) and \(m_s=\)GET_MASS(\(s\)), then in the SymPIC code, the motion equation for the \(p\)-th particle of the \(s\)-th species is
       $$\ddot{\mathbf{x}}_{sp}=\frac{q_s}{m_s}\left(\mathbf{E}(\mathbf{x}_{sp})+\dot{\mathbf{x}}_{sp}\times\mathbf{B}(\mathbf{x}_{sp})\right)$$
       and the Maxwell&apos;s equations are 
       $$\begin{eqnarray*}
       \dot{\mathbf{B}}&amp;=&amp;-\nabla\times\mathbf{E}\\
       \dot{\mathbf{E}}&amp;=&amp;\nabla\times\mathbf{B}-\sum_\mathrm{s,p}q_s\dot {\mathbf{x}}_{sp}\delta (\mathbf{x}-\mathbf{x}_{sp})
       \end{eqnarray*}$$</p> <p>In practice, we may set the rest mass of the electrons to 1, and in this case all units are fixed. Some units of physical quantities are shown in the following table, where \(-q_e\) and \(m_e\) are the charge and rest mass of electrons, \(\mu_0\) is the permeability of the vacuum.</p> <table align="center"><tr><th>Physical quantity</th> <th>Unit</th></tr> <tr><td>Number Density</td> <td>\(\Delta x^{-3}\)</td></tr> <tr><td>Charge</td> <td>\(\sqrt{\frac{m_e\Delta x}{\mu_0}}\)</td></tr> <tr><td>Magnetic Field</td> <td>\(\mathrm{c}\sqrt{\frac{\mu_0m_e}{\Delta x^3}}\)</td></tr> <tr><td>Electric Field</td> <td>\(\mathrm{c}^2\sqrt{\frac{\mu_0m_e}{\Delta x^3}}\)</td></tr> <tr><td>Current Density</td> <td>\(\mathrm{c}\sqrt{\frac{m_e}{\mu_0\Delta x^5}}\)</td></tr> <tr><td>Current</td> <td>\(\mathrm{c}\sqrt{\frac{m_e}{\mu_0\Delta x}}\)</td></tr></table> <h3>4.5 Boundary Conditions</h3> <p>By default, periodic boundary in all x, y, z directions are used. To use PEC and ABC boundaries, USE_NP_BOUNDARY should be set to 1. Use USE_PEC_DIR and USE_ABC_DIR to specify the directions of PEC and ABC boundary needed. Their effects are shown as follows.</p> <table align="center"><tr><th>Value of USE_PEC_DIR/USE_ABC_DIR</th> <th>0</th> <th>1</th> <th>2</th> <th>3</th> <th>4</th> <th>5</th> <th>6</th> <th>7</th></tr> <tr><td>Applied direction(s)</td> <td width="80">None</td> <td width="80">x</td> <td width="80">y</td> <td width="80">x and y</td> <td width="80">z</td> <td width="80">x and z</td> <td width="80">y and z</td> <td width="80">x, y and z</td></tr></table> <h2>5 Source Setup</h2> <p>To be added.</p> <h2>6 Parallel Runtime Setup</h2> <p>Use the NUM_RUNTIME parameter to specify the number of runtimes in one MPI process that are used, and GET_DEV_TYPE and GET_DEV_ID are used to specify the parallel device type and id. For example, if the compiled code contains only 1 kind of parallel runtimes, No. 0 runtime is OpenMP, then</p> <script> function func_mcl_20() {var x = document.getElementById("DIV_ID_20");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,249,249);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_20" onClick="event.cancelBubble=true;func_mcl_20()">(<block style="color:RGB(192,0,0);">begin</block><br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> NUM_RUNTIME <block style="color:RGB(192,0,192);">1</block>)<br>&nbsp;&nbsp;<script> function func_mcl_21() {var x = document.getElementById("DIV_ID_21");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,237,237);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_21" onClick="event.cancelBubble=true;func_mcl_21()">(<block style="color:RGB(192,0,0);">define</block> (GET_DEV_TYPE x_runtime rank) <block style="color:RGB(192,0,192);">0</block>)</div><br>&nbsp;&nbsp;<script> function func_mcl_22() {var x = document.getElementById("DIV_ID_22");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,237,237);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_22" onClick="event.cancelBubble=true;func_mcl_22()">(<block style="color:RGB(192,0,0);">define</block> (GET_DEV_ID x_runtime rank) <block style="color:RGB(192,0,192);">0</block>)</div>)</div> <p>will set each MPI process only use 1 runtime which is OpenMP.</p> <p>If the compiled code contains 2 types of parallel runtimes, No. 0 runtime is CUDA, and No. 1 is OpenMP, then </p> <script> function func_mcl_23() {var x = document.getElementById("DIV_ID_23");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,249,249);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_23" onClick="event.cancelBubble=true;func_mcl_23()">(<block style="color:RGB(192,0,0);">begin</block><br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> NUM_RUNTIME <block style="color:RGB(192,0,192);">3</block>)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> GET_DEV_TYPE <script> function func_mcl_24() {var x = document.getElementById("DIV_ID_24");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,231,231);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_24" onClick="event.cancelBubble=true;func_mcl_24()">(<block style="color:RGB(192,0,0);">lambda</block> (x_runtime rank)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">case</block> x_runtime (<block style="color:RGB(192,0,192);">0</block> <block style="color:RGB(192,0,192);">0</block>) (<block style="color:RGB(192,0,192);">1</block> <block style="color:RGB(192,0,192);">0</block>) (<block style="color:RGB(192,0,192);">2</block> <block style="color:RGB(192,0,192);">1</block>) (<block style="color:RGB(192,0,0);">else</block> <block style="color:RGB(192,0,192);">0</block>)))</div>)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> GET_DEV_ID <script> function func_mcl_25() {var x = document.getElementById("DIV_ID_25");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,231,231);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_25" onClick="event.cancelBubble=true;func_mcl_25()">(<block style="color:RGB(192,0,0);">lambda</block> (x_runtime rank)<br>&nbsp;&nbsp;(<block style="color:RGB(192,0,0);">define</block> rk_rem (<block style="color:RGB(0,128,32);">*</block> <block style="color:RGB(192,0,192);">2</block> (<block style="color:RGB(0,128,32);">remainder</block> rank <block style="color:RGB(192,0,192);">2</block>)))<br>&nbsp;&nbsp;<script> function func_mcl_26() {var x = document.getElementById("DIV_ID_26");if (x.style.height == "") {x.style.height="1.5em";} else {x.style.height="";}} </script><div style="overflow:hidden;margin-left:20px;background-color:RGB(255,219,219);border-style:solid;border-color: RGB(128,192,192);border-width:thin thin thin thin;" id="DIV_ID_26" onClick="event.cancelBubble=true;func_mcl_26()">(<block style="color:RGB(192,0,0);">if</block> (<block style="color:RGB(0,128,32);">&lt;</block> x_runtime <block style="color:RGB(192,0,192);">2</block>)<br>&nbsp;&nbsp;(<block style="color:RGB(0,128,32);">+</block> rk_rem x_runtime)<br>&nbsp;&nbsp;<block style="color:RGB(192,0,192);">0</block>)</div>)</div>))</div> <p>will set the even number of MPI process using No. 0, 1 CUDA GPU and OpenMP, odd number of MPI process using No. 2, 3 CUDA GPU and OpenMP. Note that for multi-GPU system, if we assign more than one CUDA GPU in one process, due to the low efficiency of CUDA runtime this could harm the performance, however using more MPI processes will cause more communications that will also harm the performance. So some trade-off will need to be considered.</p> <h2>7 Output Setup</h2> <p>Electromagnetic fields as well as some density profiles are outputed every NUM_DUMP_TIMESTEP time steps.</p> <h2>8 Checkpoint Setup</h2> <p>To use checkpoint, USE_CHECKPOINT should be set to 1. In this case checkpoint will be outputed every NUM_CHECKPOINT_TIMESTEP time steps. The program will automatically search available checkpoint when starting.</p> <h2>9 Algorithm Selection</h2> <p>The SymPIC is designed to support multiple types of PIC schemes. Currently it support the 2nd-order non-relativistic and the 1st-order relativistic electromagnetic symplectic schemes, and the 2nd-order non-relativistic adiabatic electron-kinetic ion model. The default algorithm is the 2nd-order explicit charge-conservative electromagnetic PIC scheme. To use the 1st-order relativistic electromagnetic PIC scheme, the USE_REL should be set to 1. To use the 2nd-order low frequency adiabatic electron-kinetic ion model, USE_ITG should be set to 1.</p> <h2>10 Examples</h2> <a href="landau_doc_cn.html">1. Landau Damping (CN)</a> <br> <a href="ibw_doc.html">2. Dispersion Relation of Ion Bernstein Waves</a></html>